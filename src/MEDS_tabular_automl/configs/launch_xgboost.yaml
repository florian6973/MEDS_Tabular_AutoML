defaults:
  - default
  - tabularization: default
  - override hydra/sweeper: optuna
  - override hydra/sweeper/sampler: tpe
  - _self_

task_name: task

# Raw data
input_dir: ${MEDS_cohort_dir}/${task_name}
input_code_metadata: ${MEDS_cohort_dir}/code_metadata.parquet
# Where to output the model and cached data
output_dir: ${MEDS_cohort_dir}/model/model_${now:%Y-%m-%d_%H-%M-%S}
output_filepath: ${output_dir}/model_metadata.parquet
cache_dir: ${MEDS_cohort_dir}/.cache

# Model parameters
model_params:
  num_boost_round: 1000
  early_stopping_rounds: 5
  model:
    booster: gbtree
    device: cpu
    nthread: 1
    tree_method: hist
    objective: binary:logistic
  iterator:
    keep_data_in_memory: True
    binarize_task: True

# Sweep parameters for Optuna
hydra:
  # Optuna Sweeper
  sweeper:
    sampler:
      seed: ${seed}
    storage: null
    study_name: tabularize_study_${now:%Y-%m-%d_%H-%M-%S}
    direction: minimize
    n_trials: 10

    # Define search space for Optuna
    params:
      window_sizes:
        _target_: hydra.utils.call(${hydra.utils.cross_product},
          values=["1d", "7d", "30d", "365d", "full"], min_options=1)
